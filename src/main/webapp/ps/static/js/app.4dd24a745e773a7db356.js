webpackJsonp([1],{"7QVd":function(t,e){},GKrx:function(t,e){},"M+a0":function(t,e){},NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("7+uW"),s={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var o=i("VU/8")({name:"App"},s,!1,function(t){i("GKrx")},null,null).exports,r=i("/ocq"),a={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"topToolBar-component zIndexSuperTop"},[i("div",{staticClass:"item",on:{click:t.historyBack}},[t._v("撤回"),i("i",{staticClass:"iconfont icon-jijiangdaozhang"})]),t._v(" "),i("div",{staticClass:"item",on:{click:t.historyRemake}},[t._v("重做"),i("i",{staticClass:"iconfont icon-zuji"})]),t._v(" "),i("div",{staticClass:"item",on:{click:t.submitBtn}},[t._v("保存"),i("i",{staticClass:"iconfont icon-selectfill"})]),t._v(" "),i("div",{staticClass:"item",on:{click:t.refreshPage}},[t._v("刷新"),i("i",{staticClass:"iconfont icon-refresh"})]),t._v(" "),i("div",{staticClass:"item",on:{click:t.showNumberOfWork}},[i("span",{directives:[{name:"show",rawName:"v-show",value:!t.isShowNumberofwork,expression:"!isShowNumberofwork"}]},[t._v("显示工作人数")]),i("span",{directives:[{name:"show",rawName:"v-show",value:t.isShowNumberofwork,expression:"isShowNumberofwork"}]},[t._v("隐藏工作人数")]),i("i",{staticClass:"iconfont icon-favfill"})]),t._v(" "),i("div",{staticClass:"item",on:{click:t.showWorkingHours}},[i("span",{directives:[{name:"show",rawName:"v-show",value:!t.isShowWorkingHours,expression:"!isShowWorkingHours"}]},[t._v("显示工作时间")]),i("span",{directives:[{name:"show",rawName:"v-show",value:t.isShowWorkingHours,expression:"isShowWorkingHours"}]},[t._v("隐藏工作时间")]),i("i",{staticClass:"iconfont icon-favfill"})])])},staticRenderFns:[]};var l=i("VU/8")({data:function(){return{}},computed:{isShowNumberofwork:function(){return this.$store.state.isShowNumberofwork},isShowWorkingHours:function(){return this.$store.state.isShowWorkingHours}},methods:{historyBack:function(){},historyRemake:function(){},submitBtn:function(){},refreshPage:function(){},showNumberOfWork:function(){},showWorkingHours:function(){}}},a,!1,function(t){i("V4N1")},"data-v-e127bfb4",null).exports,c=i("Zrlr"),f=i.n(c),h=i("wxAW"),d=i.n(h),u=function(){function t(){f()(this,t)}return d()(t,null,[{key:"zeroFillOfMonthOrDay",value:function(t){return 2==(t+"").length?t:"0"+t}},{key:"getDayCountOfMonth",value:function(t,e){return new Date(t,e,0).getDate()}},{key:"isWeekEnd",value:function(e,i,n){i=t.zeroFillOfMonthOrDay(i),n=t.zeroFillOfMonthOrDay(n);var s=new Date(e+"/"+i+"/"+n+" 00:00:00");return 0==s.getDay()||6==s.getDay()}},{key:"strToTimeStamp",value:function(e){var i=e.split("-"),n=i[0],s=t.zeroFillOfMonthOrDay(i[1]),o=t.zeroFillOfMonthOrDay(i[2]);return new Date(n+"/"+s+"/"+o+" 00:00:00").getTime()}},{key:"timeStampToDate",value:function(e){var i=new Date(e);return i.getFullYear()+"-"+t.zeroFillOfMonthOrDay(i.getMonth()+1)+"-"+t.zeroFillOfMonthOrDay(i.getDate())}},{key:"timeStampsToDayCount",value:function(e,i){var n=i-e;return Math.ceil(n/t.timeStampOfOneDay)}},{key:"timeStampsToDateStrList",value:function(e,i){var n=[],s=t.timeStampsToDayCount(e,i);n.push(t.timeStampToDate(e));for(var o=0;o<s;o++)n.push(t.timeStampToDate(e+(o+1)*t.timeStampOfOneDay));return n}},{key:"indexToDateStr",value:function(e){var i=t.firstTimeStampOfShow+e*t.timeStampOfOneDay;return t.timeStampToDate(i)}},{key:"firstTimeStampOfShow",get:function(){var e=new Date,i=0==e.getMonth()?e.getFullYear()-1:e.getFullYear(),n=0==e.getMonth()?12:e.getMonth();n=t.zeroFillOfMonthOrDay(n);t.getDayCountOfMonth(i,n);return t.strToTimeStamp(i+"-"+n+"-01")}},{key:"monthListOfShow",get:function(){for(var e=new Date,i=0==e.getMonth()?e.getFullYear()-1:e.getFullYear(),n=0==e.getMonth()?12:e.getMonth(),s=[i+"-"+(n=t.zeroFillOfMonthOrDay(n))],o=0;o<13;o++)(n=Number(n)+1)>12&&(n=1,i+=1),n=t.zeroFillOfMonthOrDay(n),s.push(i+"-"+n);return s}},{key:"yearListOfShow",get:function(){var e=t.monthListOfShow,i=e[0],n=e[e.length-1],s=[];return i=i.split("-")[0],n=n.split("-")[0],s.push(i),i!=n&&s.push(n),s}},{key:"dayCountOfShow",get:function(){var e=new Date,i=0==e.getMonth()?e.getFullYear()-1:e.getFullYear(),n=0==e.getMonth()?12:e.getMonth();n=t.zeroFillOfMonthOrDay(n);for(var s=t.getDayCountOfMonth(i,n),o=0;o<13;o++)(n=Number(n)+1)>12&&(n=1,i+=1),n=t.zeroFillOfMonthOrDay(n),s+=t.getDayCountOfMonth(i,n);return s}},{key:"timeStampOfOneDay",get:function(){return 864e5}}]),t}(),O=function(){function t(){f()(this,t)}return d()(t,null,[{key:"STYLEOFTOOLBAR",get:function(){return{height:37,lineWidth:1}}},{key:"STYLEOFPRODUCTLINESBAR",get:function(){return{height:49,width:124,lineWidth:1}}},{key:"STYLEOFCELL",get:function(){return{width:22,height:34,lineWidth:1,borderColor:"#ddd",activedBackgroundColor:"#fffaf2"}}},{key:"STYLEOFPROGRESSBAR",get:function(){return{top:3,height:30,lineWidth:1,fontStyle:"14px Arial",paddingLeft:4}}}]),t}(),g={props:["productLineList"],data:function(){return{}},computed:{styleOfProductLinesClass:function(){return this.$store.state.cssAboutScroll.styleOfProductLinesClass},styleOfTitleClass:function(){return{position:"fixed",top:O.STYLEOFTOOLBAR.height-O.STYLEOFTOOLBAR.lineWidth+"px",left:"0px",height:O.STYLEOFPRODUCTLINESBAR.height+"px",lineHeight:O.STYLEOFPRODUCTLINESBAR.height+"px",width:O.STYLEOFPRODUCTLINESBAR.width+"px"}},styleOfProductLinesHook:function(){return{marginTop:O.STYLEOFPRODUCTLINESBAR.height+"px"}}},watch:{scrollDirection:function(){console.log(345)}},created:function(){},methods:{}},L={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"productLineBar-component"}},[i("div",{ref:"productLinesBarHook",staticClass:"productLines zIndexSuper",style:t.styleOfProductLinesClass},[i("div",{staticClass:"title",style:t.styleOfTitleClass},[t._v("\n            生产线\n        ")]),t._v(" "),i("div",{staticClass:"productLinesHook",style:t.styleOfProductLinesHook},t._l(t.productLineList,function(e,n){return i("div",{key:n,staticClass:"productLine"},[t._v("\n                "+t._s(e.fullName)+"\n            ")])}),0)])])},staticRenderFns:[]};var S=i("VU/8")(g,L,!1,function(t){i("RBs+")},"data-v-62aee5dc",null).exports,p={data:function(){return{monthListOfShow:u.monthListOfShow}},computed:{styleOfMonthsClass:function(){return this.$store.state.cssAboutScroll.styleOfMonthsClass}},methods:{getDays:function(t){var e=t.split("-")[0],i=t.split("-")[1];return u.getDayCountOfMonth(e,i)},isHoliday:function(t,e){var i=t.split("-")[0],n=t.split("-")[1];return this.$store.state.factoryCalendarObj.isHoliday(u.strToTimeStamp(i+"-"+n+"-"+e))}},created:function(){}},m={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"dateBar-component"},[i("div",{ref:"monthsHook",staticClass:"months zIndexTop",style:t.styleOfMonthsClass},t._l(t.monthListOfShow,function(e,n){return i("div",{key:n,staticClass:"month"},[i("div",{staticClass:"monthTxt"},[t._v("\n                "+t._s(e)+"\n            ")]),t._v(" "),t._l(t.getDays(e),function(n,s){return i("div",{key:s,staticClass:"singleItem",class:{weekend:t.isHoliday(e,n)}},[t._v("\n                "+t._s(n)+"\n            ")])})],2)}),0)])},staticRenderFns:[]};var T=i("VU/8")(p,m,!1,function(t){i("O515")},"data-v-54c49d17",null).exports,w={props:["countOfProductLines"],data:function(){return{dayCountOfShow:u.dayCountOfShow}},computed:{msgOfCanvas:function(){return{width:this.dayCountOfShow*(O.STYLEOFCELL.width+2*O.STYLEOFCELL.lineWidth),height:this.countOfProductLines*(O.STYLEOFCELL.height+2*O.STYLEOFCELL.lineWidth)+O.STYLEOFCELL.lineWidth,top:O.STYLEOFPRODUCTLINESBAR.height+O.STYLEOFTOOLBAR.height-O.STYLEOFPRODUCTLINESBAR.lineWidth-O.STYLEOFTOOLBAR.lineWidth+"px",left:O.STYLEOFPRODUCTLINESBAR.width-O.STYLEOFPRODUCTLINESBAR.lineWidth+"px"}}},mounted:function(){var t=this.$refs.background.getContext("2d");t.lineWidth=O.STYLEOFCELL.lineWidth,t.strokeStyle=O.STYLEOFCELL.borderColor,t.fillStyle=O.STYLEOFCELL.activedBackgroundColor;for(var e=this.dayCountOfShow,i=this.countOfProductLines,n=0;n<i;n++)for(var s=0;s<e;s++)this.$store.state.factoryCalendarObj.isHoliday(u.indexToDateStr(s))&&t.fillRect(s*(O.STYLEOFCELL.width+2*O.STYLEOFCELL.lineWidth)+.5,n*(O.STYLEOFCELL.height+2*O.STYLEOFCELL.lineWidth)+.5,O.STYLEOFCELL.width+2*O.STYLEOFCELL.lineWidth,O.STYLEOFCELL.height+2*O.STYLEOFCELL.lineWidth),t.strokeRect(s*(O.STYLEOFCELL.width+2*O.STYLEOFCELL.lineWidth)+.5,n*(O.STYLEOFCELL.height+2*O.STYLEOFCELL.lineWidth)+.5,O.STYLEOFCELL.width+2*O.STYLEOFCELL.lineWidth,O.STYLEOFCELL.height+2*O.STYLEOFCELL.lineWidth)},methods:{}},v={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"backgroundCanvas-component",style:{top:this.msgOfCanvas.top,left:this.msgOfCanvas.left}},[e("canvas",{ref:"background",staticClass:"background",attrs:{width:this.msgOfCanvas.width,height:this.msgOfCanvas.height}})])},staticRenderFns:[]};var y,E=i("VU/8")(w,v,!1,function(t){i("wANA")},"data-v-d35f3d0e",null).exports,C=function(){function t(){f()(this,t)}return d()(t,null,[{key:"takeOffPX",value:function(t){return t.split("px")[0]}},{key:"decimalToPercent",value:function(t){return(100*t).toFixed(0)+"%"}}]),t}(),R=function(){function t(){f()(this,t)}return d()(t,null,[{key:"timeStampToX",value:function(t){var e=t-u.firstTimeStampOfShow,i=Math.floor(e/u.timeStampOfOneDay),n=e-i*u.timeStampOfOneDay,s=Number((n/u.timeStampOfOneDay).toFixed(1));return Math.floor(i*(O.STYLEOFCELL.width+2*O.STYLEOFCELL.lineWidth)+s*O.STYLEOFCELL.width)}},{key:"differenceTimeStampToWidth",value:function(e,i){return t.timeStampToX(i)-t.timeStampToX(e)}},{key:"productLineIndexToY",value:function(t){return t*(O.STYLEOFCELL.height+2*O.STYLEOFCELL.lineWidth)+O.STYLEOFPROGRESSBAR.top}}]),t}(),Y=function(){function t(){f()(this,t)}return d()(t,null,[{key:"yToProductLineIndex",value:function(t,e){var i=Math.ceil(e/(O.STYLEOFCELL.height+2*O.STYLEOFCELL.lineWidth)),n=t.length;return n>=i?i-1:n-1}},{key:"yToProductLine",value:function(e,i){return e[t.yToProductLineIndex(e,i)]}},{key:"xToTimeStamp",value:function(t){return u.firstTimeStampOfShow+Math.floor(t/(O.STYLEOFCELL.width+2*O.STYLEOFCELL.lineWidth))*u.timeStampOfOneDay}}]),t}(),P={props:["productLineList",""],data:function(){return{factoryCalendar:null,dayCountOfShow:u.dayCountOfShow,ctxOfSource:null,ctxOfTemp:null,beforeProductLineIndex:null,afterProductLineIndex:null}},computed:{msgOfCanvas:function(){return{width:this.dayCountOfShow*(O.STYLEOFCELL.width+2*O.STYLEOFCELL.lineWidth),height:this.productLineList.length*(O.STYLEOFCELL.height+2*O.STYLEOFCELL.lineWidth)+O.STYLEOFCELL.lineWidth,top:O.STYLEOFPRODUCTLINESBAR.height+O.STYLEOFTOOLBAR.height-O.STYLEOFPRODUCTLINESBAR.lineWidth-O.STYLEOFTOOLBAR.lineWidth,left:O.STYLEOFPRODUCTLINESBAR.width-O.STYLEOFPRODUCTLINESBAR.lineWidth}},isShowCtxOfTmp:function(){return this.$store.state.isShowCtxOfTmp}},mounted:function(){var t=this,e=this.$refs.sourceCanvas.getContext("2d"),i=this.$refs.tempCanvas.getContext("2d");this.$store.commit("setCtxOfSource",e),this.ctxOfSource=e,this.$store.commit("setCtxOfTemp",i),this.ctxOfTemp=i,this.productLineList.forEach(function(e){e.getProgressList.forEach(function(e){e.render(t.ctxOfSource)})})},created:function(){this.factoryCalendar=this.$store.state.factoryCalendarObj},methods:{mousedownOfSourceCanvas:function(t){var e=this.getProgressBarByXY(t);null!=e&&(this.beforeProductLineIndex=e.getProductLineIndex,this.$store.commit("toggleIsShowCtxOfTmp"),this.productLineList[e.getProductLineIndex].clear(this.ctxOfSource),this.productLineList[e.getProductLineIndex].renderWithOutIdList(this.ctxOfSource,[e.getId]),e.render(this.ctxOfTemp),this.$store.commit("setActivedProgressBar",e))},mousemoveOfSourceCavnas:function(t){clearTimeout(y);var e=this;t.clientX,this.msgOfCanvas.left,window.pageXOffset,t.clientY,this.msgOfCanvas.top,window.pageYOffset;y=setTimeout(function(){e.getProgressBarByXY(t)},500)},mousemoveOfTempCanvas:function(t){var e=this.$store.state.activedProgressBar,i=this.msgOfCanvas.width+O.STYLEOFPRODUCTLINESBAR.width,n=this.msgOfCanvas.height+this.msgOfCanvas.top,s=document.body.clientWidth,o=document.body.clientHeight;if(s-t.clientX<4*O.STYLEOFCELL.width){var r=i-(window.pageXOffset+s);r>50?window.scroll(window.pageXOffset+50,window.pageYOffset):0<r&&r<=50&&window.scroll(i-s,window.pageYOffset)}else t.clientX<2*O.STYLEOFCELL.width+O.STYLEOFPRODUCTLINESBAR.width&&(window.pageXOffset>50?window.scroll(window.pageXOffset-50,window.pageYOffset):0<window.pageXOffset&&window.pageXOffset<=50&&window.scroll(0,window.pageYOffset));if(o-t.clientY<4*O.STYLEOFCELL.height){var a=n-(window.pageYOffset+o);a>50?window.scroll(window.pageXOffset,window.pageYOffset+50):0<a&&a<=50&&window.scroll(window.pageXOffset,n-o)}else t.clientY<2*O.STYLEOFCELL.height+this.msgOfCanvas.top&&(window.pageYOffset>50?window.scroll(window.pageXOffset,window.pageYOffset-50):0<window.pageYOffset&&window.pageYOffset<=50&&window.scroll(window.pageXOffset,0));var l=t.clientX-this.msgOfCanvas.left+window.pageXOffset,c=t.clientY-this.msgOfCanvas.top+window.pageYOffset;e.move(this.ctxOfTemp,l,c)},mouseupOfTempCanvas:function(t){var e=this.$store.state.activedProgressBar,i=this.productLineList,n=t.clientX-this.msgOfCanvas.left+window.pageXOffset,s=t.clientY-this.msgOfCanvas.top+window.pageYOffset;this.afterProductLineIndex=Y.yToProductLineIndex(i,s);var o=i[this.afterProductLineIndex],r=null;null!=e.getProductLineIndex&&(r=i[this.beforeProductLineIndex]);var a=Y.xToTimeStamp(n);if(console.log("鼠标松开按键时的所在生产生产线："+o.fullName),this.ctxOfTemp.clearRect(0,0,this.ctxOfTemp.canvas.offsetWidth,this.ctxOfTemp.canvas.offsetHeight),this.$store.commit("toggleIsShowCtxOfTmp"),null==o.getEfficiency(e.getProductStyleName))return this.showToast("生产线没有相对弈的效率",null),void(r&&(r.clear(this.ctxOfSource),r.renderWithOutIdList(this.ctxOfSource,null)));r&&r.removeProgressById(e.getId),e.reload(o,this.factoryCalendar,a),console.log(u.timeStampToDate(e.getStartTime)),console.log(u.timeStampToDate(e.getEndTime)),this.beforeProductLineIndex!=this.afterProductLineIndex?console.log("进度条移出了原来的生产线"):console.log("进度条没有移出原来的生产线"),o.clear(this.ctxOfSource),o.addProgress(e,this.factoryCalendar),o.renderWithOutIdList(this.ctxOfSource,null),console.log(o.getProgressList)},getProgressBarByXY:function(t){for(var e=t.clientX-this.msgOfCanvas.left+window.pageXOffset,i=t.clientY-this.msgOfCanvas.top+window.pageYOffset,n=Y.yToProductLineIndex(this.productLineList,i),s=this.productLineList[n].getProgressList,o=0;o<s.length;o++)if(s[o].isInArea(e,i))return s[o];return null}}},F={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"progressBarCanvas-component",style:{top:t.msgOfCanvas.top+"px",left:t.msgOfCanvas.left+"px"}},[i("canvas",{ref:"sourceCanvas",staticClass:"sourceCanvas",attrs:{width:t.msgOfCanvas.width,height:t.msgOfCanvas.height},on:{mousedown:function(e){return t.mousedownOfSourceCanvas(e)},mousemove:function(e){return t.mousemoveOfSourceCavnas(e)}}}),t._v(" "),i("canvas",{directives:[{name:"show",rawName:"v-show",value:t.isShowCtxOfTmp,expression:"isShowCtxOfTmp"}],ref:"tempCanvas",staticClass:"tempCanvas zIndexTop",attrs:{width:t.msgOfCanvas.width,height:t.msgOfCanvas.height},on:{mousemove:function(e){return t.mousemoveOfTempCanvas(e)},mouseup:function(e){return t.mouseupOfTempCanvas(e)}}})])},staticRenderFns:[]};var x=i("VU/8")(P,F,!1,function(t){i("l1nc")},"data-v-2a0f7cda",null).exports,k=function(){function t(e,i,n){f()(this,t),this.productLineIndex=e,this.productionlineId=i,this.id=n.id,this.qtyFinish=n.qtyFinish,this.sam=n.sam,this.qtyofbatcheddelivery=n.qtyofbatcheddelivery,this.efficiencyOfClass=n.efficiencyOfClass,this.productStyleName=n.productStyleName,this.startTime=n.startTime,this.endTime=n.endTime,this.msgOfProgressBar=n,this.needWorkDayCount=null}return d()(t,[{key:"reload",value:function(t,e,i){this.startTime=i,this.setEndTime(t,e,i),this.productionlineId=t.getId,this.productLineIndex=t.getIndex}},{key:"setEndTime",value:function(t,e,i){var n=t.getEfficiency(this.productStyleName);if(null==n)return null;var s=t.getPeopleNumByDate(i),o=t.getWorkHoursByDate(i),r=this.efficiencyOfClass*((this.qtyofbatcheddelivery-this.qtyFinish)*this.sam/60)*n/(s*o);console.log("("+this.efficiencyOfClass+"*(("+this.qtyofbatcheddelivery+"-"+this.qtyFinish+")*"+this.sam+"/60)*"+n+")/("+s+"*"+o+") = "+r);var a=i+Math.ceil(r*u.timeStampOfOneDay);a=e.getEndTime(i,a),this.endTime=a}},{key:"isInArea",value:function(t,e){return this.msgOfCSS.left<=t&&t<=this.msgOfCSS.width+this.msgOfCSS.left&&this.msgOfCSS.top<=e&&e<=this.msgOfCSS.top+O.STYLEOFPROGRESSBAR.height}},{key:"render",value:function(t){t.save();var e=this.msgOfCSS;t.lineWidth=O.STYLEOFPROGRESSBAR.lineWidth,t.strokeStyle="#000";var i=e.width;e.width<1&&(i=1),t.translate(e.left+.5,e.top+.5),t.beginPath(),t.moveTo(0,0),t.lineTo(i,0),t.lineTo(i,O.STYLEOFPROGRESSBAR.height),t.lineTo(0,O.STYLEOFPROGRESSBAR.height),t.lineTo(0,0),t.stroke(),t.closePath(),t.fillStyle="#fff",t.fillRect(0,0,i,O.STYLEOFPROGRESSBAR.height),t.fillStyle="#ddd",t.fillRect(0,O.STYLEOFPROGRESSBAR.height/2-.5,i,O.STYLEOFPROGRESSBAR.height/2),t.fillStyle="#3bbf67",t.fillRect(0,O.STYLEOFPROGRESSBAR.height/2-.5,i*this.getPercentOfQuantityOfWork,O.STYLEOFPROGRESSBAR.height/2),t.fillStyle="#fff",t.font=O.STYLEOFPROGRESSBAR.fontStyle,t.textBaseline="top",t.fillText(C.decimalToPercent(this.getPercentOfQuantityOfWork),O.STYLEOFPROGRESSBAR.paddingLeft,O.STYLEOFPROGRESSBAR.height/2+O.STYLEOFPROGRESSBAR.lineWidth,i-2*O.STYLEOFPROGRESSBAR.paddingLeft),t.fillStyle="#444",t.fillText(this.msgOfProgressBar.orderno,O.STYLEOFPROGRESSBAR.paddingLeft,O.STYLEOFPROGRESSBAR.lineWidth,i-2*O.STYLEOFPROGRESSBAR.paddingLeft),t.restore()}},{key:"clear",value:function(t){var e=this.msgOfCSS;t.save(),t.translate(e.left,e.top),t.clearRect(0,0,e.width+2*O.STYLEOFPROGRESSBAR.lineWidth,O.STYLEOFPROGRESSBAR.height+2*O.STYLEOFPROGRESSBAR.lineWidth),t.restore()}},{key:"move",value:function(t,e,i){var n={};0==this.msgOfCSS.width?n.width=5*O.STYLEOFCELL.width:n=this.msgOfCSS,t.save(),t.clearRect(0,0,t.canvas.offsetWidth,t.canvas.offsetHeight),t.lineWidth=O.STYLEOFPROGRESSBAR.lineWidth,t.strokeStyle="#000",t.translate(e+.5,i+.5),t.beginPath(),t.moveTo(0,0),t.lineTo(n.width,0),t.lineTo(n.width,O.STYLEOFPROGRESSBAR.height),t.lineTo(0,O.STYLEOFPROGRESSBAR.height),t.lineTo(0,0),t.stroke(),t.closePath(),t.fillStyle="#fff",t.fillRect(0,0,n.width,O.STYLEOFPROGRESSBAR.height),t.fillStyle="#ddd",t.fillRect(0,O.STYLEOFPROGRESSBAR.height/2-.5,n.width,O.STYLEOFPROGRESSBAR.height/2),t.fillStyle="#3bbf67",t.fillRect(0,O.STYLEOFPROGRESSBAR.height/2-.5,n.width*this.getPercentOfQuantityOfWork,O.STYLEOFPROGRESSBAR.height/2),t.fillStyle="#fff",t.font=O.STYLEOFPROGRESSBAR.fontStyle,t.textBaseline="top",t.fillText(C.decimalToPercent(this.getPercentOfQuantityOfWork),O.STYLEOFPROGRESSBAR.paddingLeft,O.STYLEOFPROGRESSBAR.height/2+O.STYLEOFPROGRESSBAR.lineWidth,n.width-2*O.STYLEOFPROGRESSBAR.paddingLeft),t.fillStyle="#444",t.fillText(this.msgOfProgressBar.orderno,O.STYLEOFPROGRESSBAR.paddingLeft,O.STYLEOFPROGRESSBAR.lineWidth,n.width-2*O.STYLEOFPROGRESSBAR.paddingLeft),t.restore()}},{key:"getId",get:function(){return this.id}},{key:"getProductStyleName",get:function(){return this.productStyleName}},{key:"getStartTime",get:function(){return this.startTime}},{key:"getEndTime",get:function(){return this.endTime}},{key:"getProductLineIndex",get:function(){return this.productLineIndex}},{key:"getMsgOfProgressBar",get:function(){return this.msgOfProgressBar}},{key:"getPercentOfQuantityOfWork",get:function(){return Number((this.qtyFinish/this.qtyofbatcheddelivery).toFixed(2))}},{key:"msgOfCSS",get:function(){return{width:R.differenceTimeStampToWidth(this.startTime,this.endTime),top:R.productLineIndexToY(this.productLineIndex),left:R.timeStampToX(this.startTime)}}}],[{key:"getRelationByProgressBar",value:function(t,e){return t.getStartTime<=e.getStartTime&&t.getEndTime>=e.getStartTime?"CLASH_STARTTIME":t.getStartTime<=e.getEndTime&&t.getStartTime>=e.getStartTime?"CLASH_ENDTIME":t.getEndTime<=e.getStartTime?"NO_CLASH_LOCAL_EARLY":e.getEndTime<=t.getStartTime?"NO_CLASH_COMPARE_EARLY":void 0}}]),t}(),B=function(){function t(e,i,n,s,o,r,a,l,c,h){f()(this,t),this.id=e,this.index=i,this.workgroup=n,this.workshop=s,this.lineCode=o,this.peopleNum=r,this.workhours=a,this.peopleNumOfLineList=l,this.workhoursOfLineList=c,this.efficiencyOfLineList=h,this.progressList=[]}return d()(t,[{key:"setProgressList",value:function(t){this.progressList=t}},{key:"getPeopleNumByDate",value:function(t){return this.peopleNumOfLineList.forEach(function(e){if(e.startTime<=t&&t<=e.endTime)return e.peopleNum}),this.peopleNum}},{key:"getWorkHoursByDate",value:function(t){return this.workhoursOfLineList.forEach(function(e){if(e.startTime<=t&&t<=e.endTime)return e.workhours}),this.workhours}},{key:"getEfficiency",value:function(t){var e=null;return this.efficiencyOfLineList.forEach(function(i){i.styleName==t&&(e=i.efficiency)}),e}},{key:"getProgressById",value:function(t){this.progressList.find(function(e){return e.id==t})}},{key:"getProgressIndexById",value:function(t){return this.progressList.findIndex(function(e){return e.id==t})}},{key:"removeProgressById",value:function(t){var e=this.getProgressIndexById(t);null!=e?this.progressList.splice(e,1):console.log("该生产线没有对应 id 的进度条")}},{key:"addProgress",value:function(t,e){for(var i,n,s=0,o=!1,r=t,a=0;a<this.progressList.length;a++)if(o){r=this.progressList[a];var l=k.getRelationByProgressBar(i,r);if("NO_CLASH_LOCAL_EARLY"==l){i=r;continue}if("CLASH_STARTTIME"==l){r.reload(this,e,i.getEndTime),i=r;continue}console.log(l)}else{if(i=this.progressList[a],"NO_CLASH_LOCAL_EARLY"==(n=k.getRelationByProgressBar(i,r))){s+=1;continue}if("CLASH_STARTTIME"==n)console.log("新增的进度条的 **开启时间** 与本地进度条的发生重叠"),a+=1,t.reload(this,e,i.getEndTime),this.progressList.splice(a,0,t),o=!0,i=t;else{if("CLASH_ENDTIME"!=n)continue;console.log("新增的进度条的 **结束时间** 与本地进度条的发生重叠"),this.progressList.splice(a,0,t),a+=1,i.reload(this,e,t.getEndTime),o=!0}}o||(console.log("没有发生重叠"),this.progressList.splice(s,0,t))}},{key:"clear",value:function(t){this.progressList.forEach(function(e){e.clear(t)})}},{key:"renderWithOutIdList",value:function(t,e){if(null==e)this.progressList.forEach(function(e){e.render(t)});else for(var i=0;i<this.progressList.length;i++)-1==e.indexOf(this.progressList[i].id)&&this.progressList[i].render(t)}},{key:"getId",get:function(){return this.id}},{key:"getIndex",get:function(){return this.index}},{key:"fullName",get:function(){return this.workgroup+"-"+this.workshop+"-"+this.lineCode}},{key:"getProgressList",get:function(){return this.progressList}}]),t}(),A=function(){function t(){f()(this,t),this.yearList=[],this.dayList=[],this.festivalDayList=[]}return d()(t,[{key:"addDetailByYear",value:function(t,e,i,n,s,o,r,a,l){this.yearList.push(t),this.dayList.push([a,e,i,n,s,o,r]),this.festivalDayList.push(l)}},{key:"isHoliday",value:function(t){var e=new Date(t),i=e.getFullYear(),n=e.getDay(),s=this.yearList.indexOf(i);if(-1==s)return null;var o=this.dayList[s];return null!=this.festivalDayList[s].find(function(e){return e==u.timeStampToDate(t)})||!o[n]}},{key:"getEndTime",value:function(t,e){for(var i=u.timeStampsToDayCount(t,e),n=t,s=0,o=0;o<i;o++)this.isHoliday(n)&&(i+=1,s+=1),n+=u.timeStampOfOneDay;return e+s*u.timeStampOfOneDay}}]),t}(),D={data:function(){return{tableTitle:[{title:"制单号",key:"orderno",align:"center"},{title:"客户",key:"clientName",align:"center"},{title:"计划数量",key:"qtyofbatcheddelivery",align:"center"},{title:"离厂日期",key:"deliveryoffactoryTime",align:"center",render:function(t,e){return t("div",{},u.timeStampToDate(e.row.deliveryoffactoryTime))}}]}},computed:{isShowWindow:function(){return this.$store.state.isShowWindowOfAddProgress},cssOfWindow:function(){return{top:O.STYLEOFTOOLBAR.height+O.STYLEOFTOOLBAR.lineWidth}},waitingAddProgressList:function(){return this.$store.state.waitingAddProgressList}},methods:{toggleWindow:function(){this.$store.commit("toggleIsShowWindowOfAddProgress")},dragProgress:function(t,e){var i=new k(null,null,t);this.$store.commit("setActivedProgressBar",i),this.$store.commit("toggleIsShowCtxOfTmp"),this.$store.commit("toggleIsShowWindowOfAddProgress")}}},W={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"windowOfAddProgress-component"},[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.isShowWindow,expression:"!isShowWindow"}],staticClass:"showWindowBtn zIndexSuperTop",on:{click:t.toggleWindow}},[t._v("\n            添"),i("br"),t._v("加"),i("br"),t._v("排"),i("br"),t._v("产"),i("br")]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowWindow,expression:"isShowWindow"}],staticClass:"windowOfAddProgress zIndexSuperTop",style:{top:t.cssOfWindow.top+"px"}},[i("div",{staticClass:"header"},[i("div",{staticClass:"txt"},[t._v("添 加 排 产")]),t._v(" "),i("div",{staticClass:"closeBtn",on:{click:t.toggleWindow}},[i("Icon",{attrs:{type:"ios-close-circle"}})],1)]),t._v(" "),i("div",{staticClass:"filterWrapper"}),t._v(" "),i("Table",{attrs:{height:"450",border:"",columns:t.tableTitle,data:t.waitingAddProgressList},on:{"on-row-dblclick":t.dragProgress}})],1)])},staticRenderFns:[]};var I={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"toast-component"},[e("div",{staticClass:"toastWrapper"},[this._v("\n        "+this._s(this.txt)+"\n    ")])])},staticRenderFns:[]};var _={data:function(){return{isDone:!1}},computed:{productLineList:function(){return this.$store.state.productLineList},isShowToast:function(){return this.$store.state.isShowToast},toastTxt:function(){return this.$store.state.toastTxt}},created:function(){this.getFactoryCalendar(),this.getAllForAddProgress()},methods:{getFactoryCalendar:function(){var t=this,e=u.yearListOfShow;this.axios.get(this.seieiURL+"factoryCalendar/getFactoryCalendarByYear?yearList="+e.join(",")).then(function(e){if(e.data.status)t.$Message.error(e.data.msg);else{var i=new A;e.data.data.forEach(function(t){var e=[];t.festivalList.forEach(function(t){e=e.concat(u.timeStampsToDateStrList(t.beginDate,t.endDate))}),i.addDetailByYear(t.year,t.monday,t.tuesday,t.wednesday,t.thursday,t.friday,t.saturday,t.sunday,e)}),t.$store.commit("setFactoryCalendarObj",i),t.getProductLine()}}).catch(function(e){t.$Message.error({content:"服务器异常,请刷新！！",duration:0,closable:!0}),console.log(e)})},getProductLine:function(){var t=this,e=u.yearListOfShow;this.axios.get(this.seieiURL+"productionline/getResourceDataByUserId?year="+e[0]).then(function(e){if(e.data.status)t.$Message.error(e.data.msg);else{for(var i=e.data.data,n=[],s=0;s<i.length;s++){for(var o=new B(i[s].id,s,i[s].workgroup,i[s].workshop,i[s].lineCode,i[s].workhours,i[s].peopleNum,i[s].peopleNumOfLineList,i[s].workhoursOfLineList,i[s].efficiencyOfLineList),r=[],a=0;a<i[s].productionPlanningDetailList.length;a++){var l=i[s].productionPlanningDetailList[a],c=new k(s,i[s].id,l);r.push(c)}o.setProgressList(r),n.push(o)}t.$store.commit("setProductLineList",n),t.isDone=!0}}).catch(function(e){t.$Message.error({content:"服务器异常,请刷新！！",duration:0,closable:!0}),console.log(e)})},getAllForAddProgress:function(){var t=this;this.axios.get(this.seieiURL+"productionplanningdetail/getAllForAddProgress").then(function(e){e.data.status?t.$Message.error(e.data.msg):t.$store.commit("setWaitingAddProgressList",e.data.data)}).catch(function(e){t.$Message.error({content:"服务器异常,请刷新！！",duration:0,closable:!0}),console.log(e)})}},components:{"v-topToolBar":l,"v-productLinBar":S,"v-dateBar":T,"v-backgroundCanvas":E,"v-progressBarCanvas":x,"v-windowOfAddProgressBar":i("VU/8")(D,W,!1,function(t){i("M+a0")},"data-v-afc91b40",null).exports,"v-toast":i("VU/8")({props:["txt"],data:function(){return{}}},I,!1,function(t){i("y337")},"data-v-085ce136",null).exports}},b={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"index-component"}},[i("v-topToolBar"),t._v(" "),t.isDone?i("v-productLinBar",{ref:"productLinesBarHook",attrs:{productLineList:t.productLineList}}):t._e(),t._v(" "),t.isDone?i("v-dateBar"):t._e(),t._v(" "),t.isDone?i("v-backgroundCanvas",{attrs:{countOfProductLines:t.productLineList.length}}):t._e(),t._v(" "),t.isDone?i("v-progressBarCanvas",{attrs:{productLineList:t.productLineList}}):t._e(),t._v(" "),i("v-windowOfAddProgressBar"),t._v(" "),i("v-toast",{directives:[{name:"show",rawName:"v-show",value:t.isShowToast,expression:"isShowToast"}],attrs:{txt:t.toastTxt}})],1)},staticRenderFns:[]};var N=i("VU/8")(_,b,!1,function(t){i("kVx6")},"data-v-2820da36",null).exports;n.default.use(r.a);var M=new r.a({routes:[{path:"/",name:"index",component:N}]}),$=i("mtWM"),X=i.n($),G=i("Rf8U"),U=i.n(G),H=i("NYxO");n.default.use(H.a);var z=new H.a.Store({state:{isShowNumberofwork:!1,isShowWorkingHours:!1,ctxOfSource:null,ctxOfTemp:null,cssAboutScroll:{styleOfProductLinesClass:{position:"absolute",top:O.STYLEOFTOOLBAR.height-O.STYLEOFTOOLBAR.lineWidth+"px",left:"0px",width:O.STYLEOFPRODUCTLINESBAR.width+"px"},styleOfMonthsClass:{position:"absolute",top:O.STYLEOFTOOLBAR.height-O.STYLEOFTOOLBAR.lineWidth+"px",left:O.STYLEOFPRODUCTLINESBAR.width-O.STYLEOFPRODUCTLINESBAR.lineWidth+"px"}},factoryCalendarObj:{},productLineList:[],isShowToast:!1,toastTxt:"",isShowWindowOfAddProgress:!1,waitingAddProgressList:[],activedProgressBar:null,isShowCtxOfTmp:!1},mutations:{setCtxOfSource:function(t,e){t.ctxOfSource=e},setCtxOfTemp:function(t,e){t.ctxOfTemp=e},scrollUpOrDown:function(t){t.cssAboutScroll={styleOfProductLinesClass:{position:"absolute",top:O.STYLEOFTOOLBAR.height-O.STYLEOFTOOLBAR.lineWidth+"px",left:window.pageXOffset+"px",width:O.STYLEOFPRODUCTLINESBAR.width+"px"},styleOfMonthsClass:{position:"fixed",top:O.STYLEOFTOOLBAR.height-O.STYLEOFTOOLBAR.lineWidth+"px",left:-window.pageXOffset+"px"}}},scrollRightOrLeft:function(t){t.cssAboutScroll={styleOfProductLinesClass:{position:"fixed",top:O.STYLEOFTOOLBAR.height-O.STYLEOFTOOLBAR.lineWidth-window.pageYOffset+"px",left:"0px",width:O.STYLEOFPRODUCTLINESBAR.width+"px"},styleOfMonthsClass:{position:"absolute",top:O.STYLEOFTOOLBAR.height-O.STYLEOFTOOLBAR.lineWidth+"px",left:O.STYLEOFPRODUCTLINESBAR.width-O.STYLEOFPRODUCTLINESBAR.lineWidth+"px"}}},setFactoryCalendarObj:function(t,e){t.factoryCalendarObj=e},setProductLineList:function(t,e){t.productLineList=e},showToast:function(t,e,i){t.toastTxt=e,t.isShowToast=!0},hideToast:function(t){t.isShowToast=!1},toggleIsShowWindowOfAddProgress:function(t){t.isShowWindowOfAddProgress=!t.isShowWindowOfAddProgress},setWaitingAddProgressList:function(t,e){t.waitingAddProgressList=e},setActivedProgressBar:function(t,e){t.activedProgressBar=e},toggleIsShowCtxOfTmp:function(t){t.isShowCtxOfTmp=!t.isShowCtxOfTmp}}}),V=function(){function t(){f()(this,t),this.scrollXY={x:null,y:null},this.scrollDirection=null}return d()(t,[{key:"scroll",value:function(){null==this.scrollXY.x&&(this.scrollXY.x=window.pageXOffset,this.scrollXY.y=window.pageYOffset);var t=this.scrollXY.x-window.pageXOffset,e=this.scrollXY.y-window.pageYOffset;t<0?this.scrollDirection="right":t>0?this.scrollDirection="left":e<0?this.scrollDirection="down":e>0&&(this.scrollDirection="up"),this.scrollXY.x=window.pageXOffset,this.scrollXY.y=window.pageYOffset}},{key:"getScrollXY",get:function(){return this.scrollXY}},{key:"getScrollDirection",get:function(){return this.scrollDirection}}]),t}(),j={install:function(t,e){t.mixin({data:function(){return{seieiURL:"http://localhost:8080/api/",scrollDirection:null}},methods:{showToast:function(t,e){var i=this;null==e&&(e=2e3),this.$store.commit("showToast",t),setTimeout(function(){i.$store.commit("hideToast")},e)}},created:function(){var t=this;this.$nextTick(function(){var e=new V;window.onscroll=function(){e.scroll(),"down"==e.scrollDirection||"up"==e.scrollDirection?t.$store.commit("scrollUpOrDown"):"right"!=e.scrollDirection&&"left"!=e.scrollDirection||t.$store.commit("scrollRightOrLeft")}})}})}},q=i("b3L9"),Q=i.n(q);i("7QVd");n.default.config.productionTip=!1,n.default.use(U.a,X.a),n.default.use(j),n.default.use(Q.a),new n.default({el:"#app",router:M,store:z,components:{App:o},template:"<App/>"})},O515:function(t,e){},"RBs+":function(t,e){},V4N1:function(t,e){},kVx6:function(t,e){},l1nc:function(t,e){},wANA:function(t,e){},y337:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.4dd24a745e773a7db356.js.map